<script type="text/javascript" charset="utf-8">
$(function () {
  $('.star-rating').raty({
    path: '/assets',
    readOnly: 'true',
    score: function(){
      return $(this).attr('data-score');
    }
  });
})
</script>


<div class="panel panel-default">
  <div class="panel-heading">
    <div class="pull-left">
      <%= link_to 'Back', books_path, class: 'btn btn-default btn-xs' %>
    </div>
    <% if user_signed_in? %>
    <div class="pull-right">
      <%= link_to edit_book_path(@book), class: 'btn btn-warning btn-xs' do %>
        <span class="glyphicon glyphicon-pencil"></span> Edit Book
      <% end %>
    </div>
    <% end %>
    <div class="clearfix"></div>
  </div>
  <div class="panel-body">
    <div class="row">
      <div class="col-md-4 col-sm-6 col-xs-12">
        <div>
          <%= image_tag @book.cover.url(:medium), {width: "100%"} %>
        </div>
      </div>
      <div class="col-md-8 col-sm-6 col-xs-12">
        <h1 class="text-primary"><%= @book.title %></h1>
        <% unless @reviews.blank? %>
        <div style="margin: 0 0 20px">
          <span class="star-rating" data-score="<%= @avg_rating %>"></span>
          <span style="margin-left: 10px"><%= @avg_rating %></span>
          <span style="margin-left: 10px"><%= @reviews_count %> reviews</span>
        </div>
        <% end %>
        <div><%= @book.description %></div>
        <hr>
        <table class="table-responsive">
          <tr>
            <td><strong>Published:</strong></td>
            <td><%= @book.year_published %>.</td>
          </tr>
          <tr>
            <td><strong>No. of pages:</strong></td>
            <td><%= @book.pages %> pages</td>
          </tr>
          <tr>
            <td><strong>ISBN:</strong></td>
            <td><%= @book.isbn %></td>
          </tr>
        </table>
      </div>
    </div>
  </div>

</div>

<div class="panel panel-default">
  <div class="panel-heading">
    Reviews
    <% if user_signed_in? %> |
      <%= link_to 'Write a Review', new_book_review_path(@book), class: 'btn btn-xs btn-info' %>
    <% end %>
  </div>
  <div class="panel-body">

    <% if @book.reviews.blank? %>
        <p>No reviews just jet.</p>
        <p>Be the first to review this book.</p>
        <%= link_to 'Write a Review', new_book_review_path(@book), class: 'btn btn-link' %>
    <% else %>
        <% @reviews.each do |review| %>
            <%= render partial: 'reviews/review', locals: {review: review} %>
        <% end %>
    <% end %>


  </div>
</div>




